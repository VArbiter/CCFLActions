# åœ¨æ‰§è¡Œè¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ä¹‹å‰ , ä½ å¿…é¡»
# 1. æœ‰ä¸€ä¸ªæºä»£ç ä»“åº“ä¸”å’Œè¿œç¨‹ä»“åº“å…³è”
# 2. æœ‰ podspec æè¿°æ–‡ä»¶(æè¿°æ–‡ä»¶ä¸€å®šè¦å…ˆéªŒè¯æ­£ç¡®æ€§)
# 3. å®‰è£… brewHome , ruby , fastlane (è‡ªå·±Google)

# éœ€è¦æ³¨æ„çš„æ˜¯ , è¿™ä¸ªæ²¡æœ‰å®¹é”™ , 
# é”™äº†æ²¡æœ‰å›æ»š , åˆ°å“ªä¸€æ­¥é”™äº† , å°±å“ªä¸€æ­¥é”™äº† , ä¹‹å‰çš„éƒ½æ˜¯æ‰§è¡ŒæˆåŠŸä¸”å®Œæ¯•çš„
# exec:
# => cd fastlane æ–‡ä»¶å¤¹æ‰€åœ¨çš„æ–‡ä»¶å¤¹
# => fastlane c t:target g:tag m:message r:repo

desc "Update pods." #æè¿°åŠŸèƒ½

lane : c do |s|
	# æ£€ç´¢åœ°å€ https://docs.fastlane.tools/actions/
	# æ‰€æœ‰å®˜æ–¹åº“ actions åœ°å€: 
	# => https://github.com/fastlane/fastlane/tree/master/fastlane/lib/fastlane/actions
	# fastlane action -> åœ¨ç»ˆç«¯ä¼šå‘Šè¯‰ä½ è¿™ä¸ª action çš„ç”¨æ³• , è¿˜æœ‰æ¯ä¸ªå‚æ•°çš„å«ä¹‰

	t = s[:t] # target
	g = s[:g] # tag
	m = s[:m] # message
	r = s[:r] # pod repo , æäº¤åˆ°å“ªä¸ªç´¢å¼•åº“ , æœ‰é’ˆå¯¹æ€§çš„å¯ä»¥å†™æ­» , æœ¬åœ°åº“å°±ä¸éœ€è¦äº†
 
	# pod install
	cocoapods( 
  		clean: true,
  		# å¡«å†™ä½ è‡ªå·±çš„ podFile è·¯å¾„ , éœ€è¦æ³¨æ„çš„æ˜¯ , è¿™é‡Œçš„è·¯å¾„å’Œ podspec ä¸åŒ ,
  		# å…¨éƒ¨æ˜¯æ ¹è·¯å¾„ , å°±æ˜¯ fastlane folder æ‰€åœ¨çš„è·¯å¾„
  		podfile: "./CCAudioPlayer-Demo/Podfile" 
	)

	# æŒ‡æ˜ç‰ˆæœ¬å· (podspec) 
	version = version_bump_podspec(
		path: "#{t}.podspec", 
		version_number: g
	)

	# git add .
	git_add(
		# æ›¿æ¢ä¸ºä½ è‡ªå·±çš„è·¯å¾„ , ä¸‹åŒ
		path: "./CCAudioPlayer/**/*"
		)

	#  git commit -m ''
	git_commit(
		path: "./CCAudioPlayer/**/*", 
		message: m
		)

	# git push origin master
	push_to_git_remote

	# åˆ¤æ–­ tag æ˜¯å¦å­˜åœ¨ , å­˜åœ¨åˆ™åˆ é™¤ , æ·»åŠ æœ€æ–°çš„
	if git_tag_exists(tag: g)
  		UI.message("tag already exists / tag å·²ç»å­˜åœ¨. ğŸ˜¶")
  		cc_remove_exist_tag(
  			tag:g
  		)
	end

	# git tag 
	add_git_tag(
  		tag: g
	)

	# git push --tags
	push_git_tags

	# pod repo push CCSpecs CCSpecs.podspec
	pod_push(
		path: "#{t}.podspec", 
		repo: r,
		allow_warnings: true
	)

end
